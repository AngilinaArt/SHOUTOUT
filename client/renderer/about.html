<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0" />
    <title>About Shoutout</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        background: transparent;
        height: 100%;
      }

      body {
        background: rgba(29, 33, 40, 0.60);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        color: #afc6f3;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        padding: 18px;
        border-radius: 16px;
        overflow: auto; /* allow content if it exceeds viewport */
        border: 1px solid rgba(175, 198, 243, 0.15);
        min-height: 100vh;
        height: 100%;
        box-shadow: 0 14px 28px rgba(0, 0, 0, 0.35), 0 0 0 1px rgba(175, 198, 243, 0.08);
      }

      .header {
        text-align: center;
        margin-bottom: 20px; /* reduced */
        padding-bottom: 14px; /* reduced */
        border-bottom: 1px solid rgba(175, 198, 243, 0.2);
      }

      .app-name {
        font-size: 22px; /* smaller to fit better */
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 6px;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .version {
        font-size: 13px; /* smaller */
        color: #afc6f3;
        opacity: 0.8;
        font-weight: 500;
      }

      .description {
        text-align: center;
        margin-bottom: 18px; /* reduced */
        line-height: 1.5; /* slightly tighter */
        color: #afc6f3;
        opacity: 0.9;
        font-size: 13px;
      }

      .section {
        margin-bottom: 18px; /* reduced */
      }

      .section-title {
        font-size: 14px; /* smaller */
        font-weight: 600;
        color: #ffffff;
        margin-bottom: 10px; /* reduced */
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .section-title::before {
        content: "";
        width: 4px;
        height: 16px; /* reduced */
        background: linear-gradient(135deg, #afc6f3, #8b9dc3);
        border-radius: 2px;
      }

      .list {
        list-style: none;
        padding-left: 16px; /* reduced */
      }

      .list li {
        margin-bottom: 6px;
        padding: 6px 10px;
        background: rgba(175, 198, 243, 0.12);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border-radius: 8px;
        border: 1px solid rgba(175, 198, 243, 0.2);
        transition: all 0.3s ease;
        font-size: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15),
          inset 0 1px 0 rgba(255, 255, 255, 0.08);
      }

      .list li:hover {
        background: rgba(175, 198, 243, 0.15);
        border-color: rgba(175, 198, 243, 0.25);
        transform: translateX(4px);
      }

      .authors {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr; /* three across to avoid wrapping */
        gap: 12px; /* reduced */
        margin-bottom: 16px; /* reduced */
      }
      @media (max-width: 900px) {
        .authors { grid-template-columns: 1fr 1fr; }
      }

      .author-card {
        background: rgba(175, 198, 243, 0.12);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(175, 198, 243, 0.25);
        border-radius: 10px;
        padding: 10px;
        text-align: center;
        transition: all 0.3s ease;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.1);
      }

      .author-card:hover {
        background: rgba(175, 198, 243, 0.15);
        border-color: rgba(175, 198, 243, 0.3);
        transform: translateY(-2px);
      }

      .author-name {
        font-weight: 600;
        color: #ffffff;
        margin-bottom: 4px;
        font-size: 12px; /* smaller */
      }

      .author-role {
        font-size: 11px;
        color: #afc6f3;
        opacity: 0.8;
      }

      .footer {
        text-align: center;
        margin-top: 18px; /* reduced */
        padding-top: 14px; /* reduced */
        border-top: 1px solid rgba(175, 198, 243, 0.2);
        color: #afc6f3;
        opacity: 0.7;
        font-size: 11px; /* smaller */
      }

      .close-btn {
        position: absolute;
        top: 10px; /* reduced */
        right: 10px; /* reduced */
        background: rgba(175, 198, 243, 0.2);
        border: 1px solid rgba(175, 198, 243, 0.3);
        color: #afc6f3;
        border-radius: 6px;
        padding: 6px 10px; /* reduced */
        cursor: pointer;
        font-size: 12px; /* reduced */
        transition: all 0.2s ease;
      }

      .close-btn:hover {
        background: rgba(175, 198, 243, 0.3);
        border-color: rgba(175, 198, 243, 0.4);
        color: #ffffff;
      }
    </style>
  </head>
  <body>
    <button
      class="close-btn"
      onclick="window.close()">
      ‚úï
    </button>

    <div class="header">
      <div class="app-name">Shoutout</div>
      <div
        class="version"
        id="version">
        Version Loading...
      </div>
    </div>

    <div
      class="description"
      id="description">
      A fun and interactive shoutout application for sending hamsters and
      messages
    </div>

    <div class="section">
      <div class="section-title">üë®‚Äçüíª Developers</div>
      <div
        class="authors"
        id="authors">
        <!-- Authors will be populated by JavaScript -->
      </div>
    </div>

    <div class="section">
      <div class="section-title">‚ú® Features</div>
      <ul
        class="list"
        id="features">
        <!-- Features will be populated by JavaScript -->
      </ul>
    </div>

    <div class="section">
      <div class="section-title">üõ†Ô∏è Technologies</div>
      <ul
        class="list"
        id="technologies">
        <!-- Technologies will be populated by JavaScript -->
      </ul>
    </div>

    <div class="section">
      <div class="section-title">üôè Attributions</div>
      <ul class="list" id="attributions"></ul>
    </div>

    <div class="footer">Made with üíñ and lots of üêπ hamsters</div>

    <script>
      // Load app information when page loads
      document.addEventListener("DOMContentLoaded", async () => {
        // Keep logs minimal in renderer; detailed logs live in preload when DEBUG_ABOUT is set

        try {
          // If version passed via query string from main, set immediately
          try {
            const params = new URLSearchParams(window.location.search);
            const verFromQuery = params.get('v');
            if (verFromQuery) {
              setVersion(verFromQuery);
            }
          } catch (_) {}
          // Use central data exposed by preload when available; UI populates on about-ready event below

          // Also listen for a one-shot event emitted by preload
          window.addEventListener('about-ready', (ev) => {
            try {
              if (ev && ev.detail) {
                if (ev.detail.version) setVersion(ev.detail.version);
                loadContent(ev.detail);
              }
            } catch (e) { console.error('‚ùå Failed to handle about-ready', e); }
          }, { once: true });

          // Prefer constant from preload for immediate availability, but don't exit early
          if (window.aboutInfo) {
            setVersion(window.aboutInfo.version);
            loadContent(window.aboutInfo);
            // If still unknown, poll briefly for the preload IPC update
            if (!window.aboutInfo.version || window.aboutInfo.version === 'Unknown') {
              let tries = 0;
              const maxTries = 20;
              const t = setInterval(() => {
                tries++;
                const v = window.aboutInfo && window.aboutInfo.version;
                if (v && v !== 'Unknown') {
                  clearInterval(t);
                  setVersion(v);
                } else if (tries >= maxTries) {
                  clearInterval(t);
                  // Silent timeout; keep existing text
                }
              }, 250);
            }
          }

          if (window.aboutInfo) {
            console.log("‚úÖ Using aboutInfo from preload", window.aboutInfo);
            loadContent(window.aboutInfo);
          }

          // Wait briefly for the bridge to attach
          if (!window.about || !window.about.getAppInfo) {
            let tries = 0;
            const maxTries = 20;
            const timer = setInterval(() => {
              tries++;
              if (window.aboutInfo) {
                clearInterval(timer);
                setVersion(window.aboutInfo.version);
                loadContent(window.aboutInfo);
              } else if (window.about && window.about.getAppInfo) {
                clearInterval(timer);
                const ai = window.about.getAppInfo();
                setVersion(ai.version);
                loadContent(ai);
              } else if (tries >= maxTries) {
                clearInterval(timer);
                // Give up quietly; placeholders remain
              }
            }, 250);
            return;
          }

          const appInfo = window.about.getAppInfo();
          setVersion(appInfo.version);
          loadContent(appInfo);
        } catch (error) {
          console.error("‚ùå Failed to load app info:", error);
          const versionEl = document.getElementById("version");
          if (versionEl) versionEl.textContent = "Version Unknown";
        }
      });

      function setVersion(v){
        const versionEl = document.getElementById("version");
        if (versionEl) versionEl.textContent = `Version ${v || 'Unknown'}`;
      }

      function loadContent(appInfo) {
        const versionEl = document.getElementById("version");
        if (versionEl) versionEl.textContent = `Version ${appInfo.version || 'Unknown'}`;

        const nameEls = document.getElementsByClassName("app-name");
        if (nameEls && nameEls[0] && appInfo.name) {
          nameEls[0].textContent = appInfo.name;
          try { document.title = `About ${appInfo.name}`; } catch(_) {}
        }

        const descEl = document.getElementById("description");
        if (descEl) {
          descEl.textContent = appInfo.description;
          // no-op
        }

        const authorsContainer = document.getElementById("authors");
        if (authorsContainer && appInfo.authors) {
          authorsContainer.innerHTML = appInfo.authors
            .map(
              (author) => `
            <div class="author-card">
              <div class="author-name">${author.split(" - ")[0]}</div>
              <div class="author-role">${author.split(" - ")[1]}</div>
            </div>
          `
            )
            .join("");
          // no-op
        }

        const featuresContainer = document.getElementById("features");
        if (featuresContainer && appInfo.features) {
          featuresContainer.innerHTML = appInfo.features
            .map((feature) => `<li>${feature}</li>`)
            .join("");
          // no-op
        }

        const technologiesContainer = document.getElementById("technologies");
        if (technologiesContainer && appInfo.technologies) {
          technologiesContainer.innerHTML = appInfo.technologies
            .map((tech) => `<li>${tech}</li>`)
            .join("");
          // no-op
        }

        const attributionsContainer = document.getElementById("attributions");
        if (attributionsContainer && appInfo.attributions) {
          attributionsContainer.innerHTML = appInfo.attributions
            .map((item) => `<li>${item}</li>`)
            .join("");
          // no-op
        }
      }
    </script>
  </body>
</html>
